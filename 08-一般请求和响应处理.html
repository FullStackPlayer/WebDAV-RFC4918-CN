<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>8. 一般请求和响应处理 | WebDAV 规范文档</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="WebDAV 规范文档（RFC4918）中文版，由 FullStackplayer<fullstackplayer@outlook.com> 翻译。">
    
    <link rel="preload" href="/WebDAV-RFC4918-CN/assets/css/0.styles.ee162842.css" as="style"><link rel="preload" href="/WebDAV-RFC4918-CN/assets/js/app.d0fcd263.js" as="script"><link rel="preload" href="/WebDAV-RFC4918-CN/assets/js/2.b234bd97.js" as="script"><link rel="preload" href="/WebDAV-RFC4918-CN/assets/js/16.2160b144.js" as="script"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/10.2d36ed5b.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/11.826341f3.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/12.397a4e4a.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/13.8c51f8e3.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/14.8bcf862d.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/15.9388f7bb.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/17.a2a01750.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/18.d1e3ee3a.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/19.cfb3b864.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/20.fee080fb.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/21.0398293f.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/22.37711363.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/23.213f7b08.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/24.6824f26a.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/25.76a00232.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/26.b8cd79b5.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/27.c0ca86fb.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/28.48979cdf.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/29.a1f3befc.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/3.c027afa3.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/30.c033bada.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/31.65a95a86.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/32.eb55a8f4.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/33.af81e2fb.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/34.e35fd13c.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/35.9086d452.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/36.ff1ab4c9.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/37.8199be4b.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/38.26ea0256.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/39.145f8873.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/4.9aa64b6b.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/40.0d8e98c4.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/41.69087a78.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/5.9b3b8fff.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/6.689eb1da.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/7.e5d93d83.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/8.41ad8b00.js"><link rel="prefetch" href="/WebDAV-RFC4918-CN/assets/js/9.e2889826.js">
    <link rel="stylesheet" href="/WebDAV-RFC4918-CN/assets/css/0.styles.ee162842.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/WebDAV-RFC4918-CN/" class="home-link router-link-active"><!----> <span class="site-name">WebDAV 规范文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/WebDAV-RFC4918-CN/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://github.com/FullStackPlayer/WebDAV-RFC4918-CN" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://gitee.com/FullStackPlayer/WebDAV-RFC4918-CN" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="原始资料链接" class="dropdown-title"><span class="title">WebDAV 相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="原始资料链接" class="mobile-dropdown-title"><span class="title">WebDAV 相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.webdav.org/specs/rfc4918.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RFC4918原文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://datatracker.ietf.org/doc/search?name=WebDAV&amp;sort=&amp;rfcs=on&amp;activedrafts=on&amp;by=group&amp;group=" target="_blank" rel="noopener noreferrer" class="nav-link external">
  IETF相关文档集
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/WebDAV-RFC4918-CN/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://github.com/FullStackPlayer/WebDAV-RFC4918-CN" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://gitee.com/FullStackPlayer/WebDAV-RFC4918-CN" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="原始资料链接" class="dropdown-title"><span class="title">WebDAV 相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="原始资料链接" class="mobile-dropdown-title"><span class="title">WebDAV 相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.webdav.org/specs/rfc4918.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RFC4918原文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://datatracker.ietf.org/doc/search?name=WebDAV&amp;sort=&amp;rfcs=on&amp;activedrafts=on&amp;by=group&amp;group=" target="_blank" rel="noopener noreferrer" class="nav-link external">
  IETF相关文档集
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/WebDAV-RFC4918-CN/" aria-current="page" class="sidebar-link">首页</a></li><li><a href="/WebDAV-RFC4918-CN/00-扉页及目录.html" class="sidebar-link">扉页及目录</a></li><li><a href="/WebDAV-RFC4918-CN/01-概述.html" class="sidebar-link">1. 概述</a></li><li><a href="/WebDAV-RFC4918-CN/02-符号公约.html" class="sidebar-link">2. 符号公约</a></li><li><a href="/WebDAV-RFC4918-CN/03-术语.html" class="sidebar-link">3. 术语</a></li><li><a href="/WebDAV-RFC4918-CN/04-资源属性的数据模型.html" class="sidebar-link">4. 资源属性的数据模型</a></li><li><a href="/WebDAV-RFC4918-CN/05-网络资源集合.html" class="sidebar-link">5. 网络资源集合</a></li><li><a href="/WebDAV-RFC4918-CN/06-锁定.html" class="sidebar-link">6. 锁定(Locking)</a></li><li><a href="/WebDAV-RFC4918-CN/07-写入锁.html" class="sidebar-link">7. 写入锁(Write Lock)</a></li><li><a href="/WebDAV-RFC4918-CN/08-一般请求和响应处理.html" class="active sidebar-link">8. 一般请求和响应处理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/WebDAV-RFC4918-CN/08-一般请求和响应处理.html#_8-1-错误处理优先级" class="sidebar-link">8.1 错误处理优先级</a></li><li class="sidebar-sub-header"><a href="/WebDAV-RFC4918-CN/08-一般请求和响应处理.html#_8-2-xml的使用" class="sidebar-link">8.2 XML的使用</a></li><li class="sidebar-sub-header"><a href="/WebDAV-RFC4918-CN/08-一般请求和响应处理.html#_8-3-url处理" class="sidebar-link">8.3 URL处理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/WebDAV-RFC4918-CN/08-一般请求和响应处理.html#_8-3-1-示例-正确的url处理" class="sidebar-link">8.3.1 示例-正确的URL处理</a></li></ul></li><li class="sidebar-sub-header"><a href="/WebDAV-RFC4918-CN/08-一般请求和响应处理.html#_8-4-请求中需要的主体" class="sidebar-link">8.4 请求中需要的主体</a></li><li class="sidebar-sub-header"><a href="/WebDAV-RFC4918-CN/08-一般请求和响应处理.html#_8-5-webdav中使用的http报头" class="sidebar-link">8.5 WebDAV中使用的HTTP报头</a></li><li class="sidebar-sub-header"><a href="/WebDAV-RFC4918-CN/08-一般请求和响应处理.html#_8-6-etag" class="sidebar-link">8.6 ETag</a></li><li class="sidebar-sub-header"><a href="/WebDAV-RFC4918-CN/08-一般请求和响应处理.html#_8-7-包含错误响应体" class="sidebar-link">8.7 包含错误响应体</a></li><li class="sidebar-sub-header"><a href="/WebDAV-RFC4918-CN/08-一般请求和响应处理.html#_8-8-命名空间操作对缓存验证器的影响" class="sidebar-link">8.8 命名空间操作对缓存验证器的影响</a></li></ul></li><li><a href="/WebDAV-RFC4918-CN/09-WebDAV的HTTP方法.html" class="sidebar-link">9. WebDAV的HTTP方法</a></li><li><a href="/WebDAV-RFC4918-CN/10-WebDAV的HTTP报头.html" class="sidebar-link">10. WebDAV的HTTP报头</a></li><li><a href="/WebDAV-RFC4918-CN/11-HTTP1.1的状态码扩展.html" class="sidebar-link">11. HTTP/1.1的状态码扩展</a></li><li><a href="/WebDAV-RFC4918-CN/12-HTTP状态码的使用.html" class="sidebar-link">12. HTTP状态码的使用</a></li><li><a href="/WebDAV-RFC4918-CN/13-多状态响应.html" class="sidebar-link">13. 多状态(Multi-Status)响应</a></li><li><a href="/WebDAV-RFC4918-CN/14-XML元素定义.html" class="sidebar-link">14. XML元素定义</a></li><li><a href="/WebDAV-RFC4918-CN/15-DAV属性.html" class="sidebar-link">15. DAV属性</a></li><li><a href="/WebDAV-RFC4918-CN/16-前置&amp;后置条件XML元素.html" class="sidebar-link">16. 前置条件/后置条件XML元素</a></li><li><a href="/WebDAV-RFC4918-CN/17-DAV中的XML可扩展性.html" class="sidebar-link">17. DAV中的XML可扩展性</a></li><li><a href="/WebDAV-RFC4918-CN/18-DAV兼容级别.html" class="sidebar-link">18. DAV兼容级别</a></li><li><a href="/WebDAV-RFC4918-CN/19-国际化注意事项.html" class="sidebar-link">19. 国际化注意事项</a></li><li><a href="/WebDAV-RFC4918-CN/20-安全性考量.html" class="sidebar-link">20. 安全性考量</a></li><li><a href="/WebDAV-RFC4918-CN/21-IANA相关事项.html" class="sidebar-link">21. IANA注意事项</a></li><li><a href="/WebDAV-RFC4918-CN/22-致谢.html" class="sidebar-link">22. 致谢</a></li><li><a href="/WebDAV-RFC4918-CN/23-本规范的贡献者.html" class="sidebar-link">23. 此规范的贡献者</a></li><li><a href="/WebDAV-RFC4918-CN/24-RFC2518的作者.html" class="sidebar-link">24. RFC2518 的作者</a></li><li><a href="/WebDAV-RFC4918-CN/25-参考文献.html" class="sidebar-link">25. 参考文献</a></li><li><a href="/WebDAV-RFC4918-CN/其它信息.html" class="sidebar-link">其他信息</a></li><li><a href="/WebDAV-RFC4918-CN/字符序索引.html" class="sidebar-link">字符序索引</a></li><li><a href="/WebDAV-RFC4918-CN/附录A-处理XML的注意事项.html" class="sidebar-link">附录A. 处理XML元素的注意事项</a></li><li><a href="/WebDAV-RFC4918-CN/附录B-HTTP客户端兼容性.html" class="sidebar-link">附录B. HTTP客户端兼容性</a></li><li><a href="/WebDAV-RFC4918-CN/附录C-“opaquelocktoken”方案和URI.html" class="sidebar-link">附录C. “opaquelocktoken”方案和URI</a></li><li><a href="/WebDAV-RFC4918-CN/附录D-[Lock-Null]资源.html" class="sidebar-link">附录D. Lock-null 资源</a></li><li><a href="/WebDAV-RFC4918-CN/附录E-客户认证激活指南.html" class="sidebar-link">附录E. 客户认证激活指南</a></li><li><a href="/WebDAV-RFC4918-CN/附录F-相比RFC2518的主要变更.html" class="sidebar-link">附录F. 相比RFC 2518的变更摘要</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_8-一般请求和响应处理"><a href="#_8-一般请求和响应处理" class="header-anchor">#</a> 8. 一般请求和响应处理</h1> <h2 id="_8-1-错误处理优先级"><a href="#_8-1-错误处理优先级" class="header-anchor">#</a> 8.1 错误处理优先级</h2> <p>服务器必须优先返回授权错误而不是其他错误。这样可以避免泄漏有关受保护资源的信息(例如，客户端通过查看匿名请求对资源的423锁定响应来发现隐藏资源存在)。</p> <h2 id="_8-2-xml的使用"><a href="#_8-2-xml的使用" class="header-anchor">#</a> 8.2 XML的使用</h2> <p>在HTTP/1.1中，method参数信息专门编码在HTTP头中。不同于HTTP/1.1，WebDAV的method参数信息有可能被编码在XML([REC-XML])格式的请求body中，也有可能在HTTP header中。使用XML来编码方法参数的出发点是能够向现有结构中添加额外的XML元素从而提供可扩展性，以及XML以iso10646字符集编码的能力，提供国际化支持。</p> <p>除了对method参数进行编码外，WebDAV还使用XML对服务器的响应进行编码，从而同时为请求和响应的输出和输入提供XML的可扩展性和国际化优势。当XML用于请求或响应主体时，内容类型类型应该是application/xml。具体实现的时候必须同时接受text/xml和application/xml作为请求和响应主体中的格式，但是text/xml格式已被废弃。</p> <p>所有DAV兼容的客户端和资源都必须使用符合[RCE-XML]和[REC-XML-NAMES]标准的的XML解析器。在请求或响应中使用的所有XML至少要求格式良好、并正确使用命名空间。如果服务器接收到的XML存在格式问题，那么服务器必须用400(Bad Request)来拒绝这个请求。如果客户端接收到的XML不是格式良好的，那么客户端一定不要对执行结果进行任何假设，而应该视作服务器故障。</p> <p>请注意，处理不受信任的来源提交的XML可能会导致涉及隐私、安全性和服务质量(参见第20节)等方面的风险。服务器可能会拒绝有问题的请求(即使它们由格式良好的XML组成)，例如，用一个400(Bad Request)状态码和一个可选的响应body来解释问题。</p> <h2 id="_8-3-url处理"><a href="#_8-3-url处理" class="header-anchor">#</a> 8.3 URL处理</h2> <p>URL出现在请求和响应中的许多位置。使用[RFC2518]的互操作经验表明，许多客户端解析多状态(Multi-Status)响应的时候并没有完全实现[RFC3986]第5节中定义的完整内容。因此，服务器在响应URL时需要特别小心，以确保客户机有足够的上下文信息来解析所有url。本节中的规则不仅适用于多状态响应中'href'元素中的资源url，也适用于Destination header和If header中的资源url。
发送方可以在两种方法中进行选择：使用相对引用(以被请求URI为起点进行解析)，或者使用完整的URI。服务器必须确保多状态响应中的每个'href'值都使用相同的格式。</p> <p>WebDAV在其扩展中只使用一种形式的相对引用，即绝对路径。</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>Simple-ref = absolute-URI | ( path-absolute [ &quot;?&quot; query ] ) 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>absolute-URI, path-absolute 和 query 均在[RFC3986]的4.3、3.3和3.4节中进行了定义。</p> <p>使用Simple-ref格式，发送者不得出现以下情况：</p> <ul><li>使用点段(“.”或“..”)，或</li> <li>拥有与请求uri不匹配的前缀(使用[RFC2616]3.2.3节中定义的比较规则)。</li></ul> <p>集合的标识符应该以'/'字符结束。</p> <h3 id="_8-3-1-示例-正确的url处理"><a href="#_8-3-1-示例-正确的url处理" class="header-anchor">#</a> 8.3.1 示例-正确的URL处理</h3> <p>现有集合 http://example.com/sample/ 和内部成员URL http://example.com/sample/a%20test ，通过PROPFIND请求如下：</p> <p>请求内容：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>PROPFIND /sample/ HTTP/1.1
Host: example.com
Depth: 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在这种情况下，服务器应该返回两个'href'元素，可以是下面任一格式</p> <ul><li>'http://example.com/sample/' 和 'http://example.com/sample/a%20test' ，或</li> <li>'/sample/'和'/sample/a%20test'</li></ul> <p>请注意，即使服务器可能将内部成员资源存储为“a test”，当在URI引用中使用时，它必须是被编码的(参见[RFC3986]的2.1节)。还要注意，合法的URI可能仍然包含需要在XML字符数据中转义的字符，如&amp;字符。</p> <h2 id="_8-4-请求中需要的主体"><a href="#_8-4-请求中需要的主体" class="header-anchor">#</a> 8.4 请求中需要的主体</h2> <p>这些新methods中的一部分不会定义body主体。但是服务器必须检查所有请求的body，即使在方法不需要body主体的情况下也是如此，以防止出现一个请求body分明存在但却被服务器忽略的情况。服务器必须拒绝415(不支持的媒体类型)请求，这将告知客户端(可能正在尝试使用扩展)不能按客户端预期的方式处理主体。</p> <h2 id="_8-5-webdav中使用的http报头"><a href="#_8-5-webdav中使用的http报头" class="header-anchor">#</a> 8.5 WebDAV中使用的HTTP报头</h2> <p>HTTP定义了许多可以用在WebDAV请求和响应中的报头。并不是所有的这些报头都适用于所有情况，有些互动可能是未被定义的。请注意，HTTP 1.1要求在所有可能的响应中使用Date header(参见14.18节[RFC2616])。</p> <p>在检查任何HTTP报头之前，服务器必须先进行授权检查。</p> <h2 id="_8-6-etag"><a href="#_8-6-etag" class="header-anchor">#</a> 8.6 ETag</h2> <p>HTTP 1.1建议使用ETags而不是修改日期来用于缓存控制。除此之外我们还有更好的理由：在分布式创作环境中，为了避免更新丢失问题，ETag和锁都是必要的，客户端有时候可能会无法更新锁，例如，当锁超时时，客户端意外脱机了或正在较长的上传过程中。当这种情况发生时，很有可能资源仍然可以被重新锁定（因为原来的锁已经超时），用户可以继续编辑，只要在此期间没有任何其它更改。客户端需要ETag来区分这种情况，否则，客户端将被迫询问用户是否要覆盖服务器上的资源，甚至无法告诉用户资源是否已经更改。时间戳几乎不能像ETag那样解决这个问题。</p> <p>在编写用例时，强ETag比弱ETag更有用(参见[RFC2616] 13.3.3节)。语义等价可能是一个有用的概念，但这取决于文档类型和应用程序类型，互操作性可能需要一些超出本规范和HTTP范围的协议或标准来协助。还要注意弱ETag在HTTP中有一定的限制，例如不能用于If-Match header。</p> <p>注意，PUT响应中ETag的意义并没有被本文档或者RFC2616所明确定义，也就是说，无论ETag意味着资源是完全等效于PUT请求的body，还是服务器已经对格式或者内容进行了微调，这是一个HTTP的问题，而不是纯粹的WebDAV问题。</p> <p>因为如果ETag发生变化，客户端可能会被迫提示用户或丢弃更改的内容，所以WebDAV服务器不应该为body和位置不变的资源修改ETag(或最后修改时间)。ETag表示资源的body或内容的状态。没有其它类似的方法来判断属性是否发生了变化。</p> <h2 id="_8-7-包含错误响应体"><a href="#_8-7-包含错误响应体" class="header-anchor">#</a> 8.7 包含错误响应体</h2> <p>HTTP和WebDAV没有将大多数错误响应的body用于机器解析信息，直到WebDAV版本扩展规范([RFC3253]第1.6节)引入了一种机制，在错误响应body中包含更多具体的信息。错误体(Error Body)机制适用于任何可能采用错误body但尚未有错误定义的错误响应。</p> <p>这一机制特别适合状态代码可能有多种意思的情况，例如，400(Bad Request)可能意味着缺少所需的header、header格式不正确、或者更多。第16节将介绍这种错误体机制。</p> <h2 id="_8-8-命名空间操作对缓存验证器的影响"><a href="#_8-8-命名空间操作对缓存验证器的影响" class="header-anchor">#</a> 8.8 命名空间操作对缓存验证器的影响</h2> <p>请注意，HTTP响应中的“ETag header”和“Last-Modified header”(参见RFC2616，章节14.19和14.29)是根据每个URL(而不是每个资源)定义的，并被客户端用于缓存。因此，服务器必须确保执行任何影响URL名称空间的操作时(如MOVE、COPY、DELETE、PUT或MKCOL)都能保留它们的语义，特别是：</p> <ul><li><p>对于任何给定的URL，“Last-Modified”的值必须在每次GET返回的内容存在改变时(在时间戳的限制内)进行更新。</p></li> <li><p>对于任何给定的URL，“ETag”值不能被复用于GET返回的不同展示。</p></li></ul> <p>在实践中，这意味着服务器：</p> <ul><li><p>可能要为命名空间操作中的目标命名空间内每个资源更新“Last-Modified”时间戳，除非它可以有选择性，</p></li> <li><p>类似地，可能必须为这些资源重新分配“ETag”值(除非服务器以另一种方式分配实体标签，以使它们在服务器管理的整个URL命名空间中是唯一的)。</p></li></ul> <p>请注意，这些注意事项也适用于特定的用例，例如使用PUT在一个URL上创建一个曾经被映射过后又被删除的新资源。</p> <p>最后，继承HTTP header语义的WebDAV属性(如DAV:getetag和DAV: getlastmodified)必须表现出相应的行为。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/WebDAV-RFC4918-CN/07-写入锁.html" class="prev">
        7. 写入锁(Write Lock)
      </a></span> <span class="next"><a href="/WebDAV-RFC4918-CN/09-WebDAV的HTTP方法.html">
        9. WebDAV的HTTP方法
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/WebDAV-RFC4918-CN/assets/js/app.d0fcd263.js" defer></script><script src="/WebDAV-RFC4918-CN/assets/js/2.b234bd97.js" defer></script><script src="/WebDAV-RFC4918-CN/assets/js/16.2160b144.js" defer></script>
  </body>
</html>
